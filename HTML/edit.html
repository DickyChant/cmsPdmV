<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="eng" ng-app="testApp">
<head>
        <title>Edit page McM</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet">
        
        <link href="scripts/codemirror-3.11/lib/codemirror.css" rel="stylesheet">
        <link href="scripts/codemirror-3.11/theme/eclipse.css" rel="stylesheet">

        <script type="text/javascript" src="scripts/underscore.js"></script>
        <script type="text/javascript" src="scripts/angular.min.js"></script>
        <script src="scripts/ui-bootstrap-custom-tpls-0.1.0-SNAPSHOT.js"></script>
        <script src="scripts/edit_controller.js"></script>

        <script src="scripts/codemirror-3.11/lib/codemirror.js"></script>
        <script src="scripts/codemirror-3.11/mode/python/python.js"></script>
        <script src="scripts/angular-ui.min.js"></script>
        
</head>
<body ng-controller="resultsCtrl">
  <div ng-include="'HTML/navbar_template.html'"></div>
  <div class="container" ng-show="role(1);">
    <b>You have not enough permission to access this ressource.</b>
  </div>
  <div class="container" ng-hide="role(1);">
    <div class="span12">
      <table class="table table-bordered table-stripped" style="margin-top: 30px;">
        <thead>
        </thead>
        <tbody>
          <tr ng-repeat="column in defaults">
            <th>
              {{column.text}}
            </th>
            <td>
              <ng-form name="antantasForm">
                <div ng-switch on="column.text">
                    <div ng-switch-when="Approvals">
                        <ng-form name="fieldForm">
                          <div inline-editable ng-model="result[column.db_name]" column="column.text"></div>
                          <font color="red" ng-show="fieldForm.$invalid">Bad JSON formatting</font>
                        </ng-form> 
                    </div>
                    <div ng-switch-when="Sequences">
                      <div sequence-edit ng-model="result[column.db_name]"></div>
                    </div>
                    <div ng-switch-when="Generators">
                        <ng-form name="fieldForm">
                          <div inline-editable ng-model="result[column.db_name]" column="column.text"></div>
                          <font color="red" ng-show="fieldForm.$invalid">Bad JSON formatting</font>
                        </ng-form>
                    </div>
                    <div ng-switch-when="Notes">
                        <ng-form name="fieldForm">
                          <div inline-editable ng-model="result[column.db_name]" column="column.text"></div>
                          <font color="red" ng-show="fieldForm.$invalid">Bad JSON formatting</font>
                        </ng-form>
                    </div>
                    <div ng-switch-when="Submission details">
                      <dl class="dl-horizontal" style="margin-bottom: 0px; margin-top: 0px;" ng-repeat="(key,value) in result[column.db_name]">
                        <dt>{{key}}</dt>
                        <dd>{{value}}</dd>                
                      </dl>
                    </div>
                    <div ng-switch-when="Generator parameters">
                      <ng-form name="fieldForm">
                        <div inline-editable ng-model="result[column.db_name]" column="column.text"></div>
                        <font color="red" ng-show="fieldForm.$invalid">Bad JSON formatting</font>
                      </ng-form>
                    </div>
                    <div ng-switch-when="History">
                      <div custom-history ng-model="result[column.db_name]"></div>
                    </div>
                    <div ng-switch-when="Valid">
                      <input type="checkbox" ng-model="result[column.db_name]">
                    </div>
                    <div ng-switch-when="Request parameters">
                      <ng-form name="fieldForm">
                        <div inline-editable ng-model="result[column.db_name]" column="column.text"></div>
                        <font color="red" ng-show="fieldForm.$invalid">Bad JSON formatting</font>
                      </ng-form>
                    </div>
                    <div ng-switch-when="Reqmgr name">
                      <ng-form name="fieldForm">
                        <div inline-editable ng-model="result[column.db_name]" column="column.text"></div>
                        <font color="red" ng-show="fieldForm.$invalid">Bad JSON formatting</font>
                      </ng-form>
                    </div>
                    <div ng-switch-when="Generator parameters">
                      <div generator-params ng-model="result[column.db_name]"></div>
                    </div>
                    <div ng-switch-when="Fragment">
                      <textarea ui-codemirror="{ theme:'eclipse', readOnly:'editableFragment()'}" ng-model="result[column.db_name]"></textarea>
                    </div>
                    <div ng-switch-default style="width: 400px;">
                      <textarea type="text" ng-model="result[column.db_name]" style="width: 390px; height: 20px; margin-bottom: 0px;" ng-disabled="not_editable_list.indexOf(column.text)!=-1"></textarea>
                    </div>
                </div>
              </form>
            </td>
          </tr>
        </tbody>
      </table>
      <div>
        <div class="span4" align="left" ng-hide="role(1);">
          <input type="button" class="btn" ng-click="submit_edit()" value="Commit" align="left" ng-hide="role(1);"/>
        </div>
        <div class="span3">
          <div ng-show="update['success']">
            Updated. Status code:<font color="green">{{update['status_code']}}</font>
          </div>
          <div ng-show="update['fail']">
            Update failed. Status code:<font color="red">{{update['status_code']}}</font>
          </div>
        </div>
        <div class="span4" align="right" ng-hide="role(3);">
          <input type="button" class="btn" ng-click="delete_edit(result['prepid'])" value="Delete" align="right" ng-hide="role(3);"/>
        </div>
      </div>
    </div><!--END of span12 -->
  </div>
</body>
</html>
